{
  "db_name": "PostgreSQL",
  "query": "\n        SELECT DISTINCT\n            p.oid AS \"func_oid!\",\n\n            -- Table or view reference\n            cls.relkind::text AS \"cls_relkind?\",\n            cls_n.nspname AS \"cls_schema?\",\n            cls.relname AS \"cls_name?\",\n            -- Column name for column-level dependencies (BEGIN ATOMIC functions, PostgreSQL 14+)\n            cls_attr.attname AS \"cls_column?\",\n\n            -- Type reference (resolve array element type)\n            CASE\n                WHEN typ.typelem != 0 THEN elem_typ.typname\n                ELSE typ.typname\n            END AS \"typ_name?\",\n            CASE\n                WHEN typ.typelem != 0 THEN elem_typ_n.nspname\n                ELSE typ_n.nspname\n            END AS \"typ_schema?\",\n            CASE\n                WHEN typ.typelem != 0 THEN elem_typ.typtype::text\n                ELSE typ.typtype::text\n            END AS \"typ_typtype?\",\n            CASE\n                WHEN typ.typelem != 0 THEN elem_typ_rel.relkind::text\n                ELSE typ_rel.relkind::text\n            END AS \"typ_relkind?\",\n            ext_dep_types.extname AS \"typ_extension_name?\",\n\n            -- Function reference\n            proc.proname AS \"proc_name?\",\n            proc_n.nspname AS \"proc_schema?\",\n            pg_catalog.pg_get_function_identity_arguments(proc.oid) AS \"proc_args?\",\n\n            -- Sequence reference\n            seq_cls.relname AS \"seq_name?\",\n            seq_n.nspname AS \"seq_schema?\"\n\n        FROM pg_proc p\n        JOIN pg_namespace n ON p.pronamespace = n.oid\n        JOIN pg_depend d ON d.objid = p.oid\n\n        -- Table/view reference\n        LEFT JOIN pg_class cls\n            ON d.refclassid = 'pg_class'::regclass::oid\n            AND d.refobjid = cls.oid\n            AND cls.relkind IN ('r', 'v', 'm', 'p') -- tables, views, materialized views, partitioned tables\n        LEFT JOIN pg_namespace cls_n ON cls.relnamespace = cls_n.oid\n        -- Column-level dependency (BEGIN ATOMIC functions in PostgreSQL 14+)\n        -- refobjsubid > 0 indicates a column reference, attnum matches refobjsubid\n        LEFT JOIN pg_attribute cls_attr\n            ON cls_attr.attrelid = cls.oid\n            AND cls_attr.attnum = d.refobjsubid\n            AND d.refobjsubid > 0\n\n        -- Type reference (with array element type resolution)\n        LEFT JOIN pg_type typ\n            ON d.refclassid = 'pg_type'::regclass::oid\n            AND d.refobjid = typ.oid\n        LEFT JOIN pg_namespace typ_n ON typ.typnamespace = typ_n.oid\n        -- Element type for array types (typelem != 0 means it's an array type)\n        LEFT JOIN pg_type elem_typ ON typ.typelem = elem_typ.oid AND typ.typelem != 0\n        LEFT JOIN pg_namespace elem_typ_n ON elem_typ.typnamespace = elem_typ_n.oid\n        -- Get relkind for composite types (to distinguish table/view from explicit composite)\n        LEFT JOIN pg_class typ_rel ON typ.typrelid = typ_rel.oid AND typ.typrelid != 0\n        LEFT JOIN pg_class elem_typ_rel ON elem_typ.typrelid = elem_typ_rel.oid AND elem_typ.typrelid != 0\n        -- Extension type lookup for pg_depend type references\n        LEFT JOIN (\n            SELECT DISTINCT dep.objid AS type_oid, e.extname\n            FROM pg_depend dep\n            JOIN pg_extension e ON dep.refobjid = e.oid\n            WHERE dep.deptype = 'e'\n        ) ext_dep_types ON ext_dep_types.type_oid = COALESCE(NULLIF(typ.typelem, 0::oid), typ.oid)\n\n        -- Function reference\n        LEFT JOIN pg_proc proc\n            ON d.refclassid = 'pg_proc'::regclass::oid\n            AND d.refobjid = proc.oid\n            AND proc.oid != p.oid  -- Don't include self-references\n        LEFT JOIN pg_namespace proc_n ON proc.pronamespace = proc_n.oid\n\n        -- Sequence reference\n        LEFT JOIN pg_class seq_cls\n            ON d.refclassid = 'pg_class'::regclass::oid\n            AND d.refobjid = seq_cls.oid\n            AND seq_cls.relkind = 'S' -- sequences\n        LEFT JOIN pg_namespace seq_n ON seq_cls.relnamespace = seq_n.oid\n\n        WHERE n.nspname NOT IN ('pg_catalog', 'information_schema', 'pg_toast')\n            AND d.deptype = 'n'  -- normal dependencies\n            AND d.refclassid IN (\n                'pg_class'::regclass::oid,    -- tables, views, sequences\n                'pg_type'::regclass::oid,     -- types\n                'pg_proc'::regclass::oid      -- functions\n            )\n            -- Exclude functions that belong to extensions\n            AND NOT EXISTS (\n                SELECT 1 FROM pg_depend dep\n                WHERE dep.objid = p.oid\n                AND dep.deptype = 'e'\n            )\n        ORDER BY p.oid\n        ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "func_oid!",
        "type_info": "Oid"
      },
      {
        "ordinal": 1,
        "name": "cls_relkind?",
        "type_info": "Text"
      },
      {
        "ordinal": 2,
        "name": "cls_schema?",
        "type_info": "Name"
      },
      {
        "ordinal": 3,
        "name": "cls_name?",
        "type_info": "Name"
      },
      {
        "ordinal": 4,
        "name": "cls_column?",
        "type_info": "Name"
      },
      {
        "ordinal": 5,
        "name": "typ_name?",
        "type_info": "Name"
      },
      {
        "ordinal": 6,
        "name": "typ_schema?",
        "type_info": "Name"
      },
      {
        "ordinal": 7,
        "name": "typ_typtype?",
        "type_info": "Text"
      },
      {
        "ordinal": 8,
        "name": "typ_relkind?",
        "type_info": "Text"
      },
      {
        "ordinal": 9,
        "name": "typ_extension_name?",
        "type_info": "Name"
      },
      {
        "ordinal": 10,
        "name": "proc_name?",
        "type_info": "Name"
      },
      {
        "ordinal": 11,
        "name": "proc_schema?",
        "type_info": "Name"
      },
      {
        "ordinal": 12,
        "name": "proc_args?",
        "type_info": "Text"
      },
      {
        "ordinal": 13,
        "name": "seq_name?",
        "type_info": "Name"
      },
      {
        "ordinal": 14,
        "name": "seq_schema?",
        "type_info": "Name"
      }
    ],
    "parameters": {
      "Left": []
    },
    "nullable": [
      false,
      null,
      false,
      false,
      false,
      null,
      null,
      null,
      null,
      false,
      false,
      false,
      null,
      false,
      false
    ]
  },
  "hash": "ec8d3d17d64cf68ba1634c387cd0c5af9b5c87f32dff52919ec2cf9e4da20d24"
}
